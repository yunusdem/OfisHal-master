@{
    ViewBag.title = "Piyasa Fiyat Listeleri";

    ViewBag.pagetitle = "Teknik İşlemler";
    ViewBag.ptitle = "Piyasa Fiyat Listeleri";
}
@section styles {
    <link rel="stylesheet" href="~/assets/js/SlickGrid/dist/styles/css/slick.columnpicker.css" type="text/css" />
    <link rel="stylesheet" href="~/assets/js/SlickGrid/dist/styles/css/slick-icons.css" type="text/css" />
    <link rel="stylesheet" href="~/assets/js/SlickGrid/dist/styles/css/slick-alpine-theme.css" type="text/css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
    <style>
        .ui-state-default.slick-header-column {
            background-color: #97c5dd;
        }

        .ui-state-default.slick-footerrow-column {
            background-color: #97c5dd;
        }

        .ui-widget-content.slick-row.even {
            background-color: #fff5da;
        }

        .ui-widget-content.slick-row.odd {
            background-color: #fcf8e3;
        }
    </style>
}
<div class="row">
    <div class="col-lg-7">
        <div class="row">
            <label for="tarih" class="col-sm-3 col-form-label pb-0">
                Tarih
            </label>
            <div class="col-sm-3">
                <input type="date" name="tarih" id="tarih" class="form-control form-control-sm" value="@DateTime.Now.ToString("yyyy-MM-dd")" />
            </div>
        </div>
        <div class="row">
            <label for="aciklama" class="col-sm-3 col-form-label pb-0">
                Açıklama
            </label>
            <div class="col-sm-9">
                <input type="text" name="aciklama" id="aciklama" class="form-control form-control-sm" />
            </div>
        </div>
        <div class="row mb-1">
            <div class="col-12">
                <table width="100%">
                    <tr>
                        <td valign="top" width="50%">
                            <input type="hidden" id="gridMal" name="gridMal" />
                            <div id="myGrid" class="slick-container" style="height:200px;"></div>
                            <div id="pager" style="width: 100%; height: 20px"></div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="row mt-2">
            <div class="col">
                <button id="listeKaydetBut" class="btn btn-sm btn-success">Kaydet</button>
            </div>
        </div>
    </div>
</div>

<div id="inlineFilterPanel" style="
    display: none;
    background: #f6f6f6;
    color: black;
    height: 100%;
    padding: 4px;
  ">
    Show tasks with title including <input type="text" id="txtSearch2" />
    and % at least &nbsp;
    <input style="width: 100px; display: inline-block" id="pcSlider2" type="range" min="1" max="100" value="1" />
</div>
<div class="modal fade" id="modal" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="modalLabel"></h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Kapat"></button>
            </div>
            <div class="modal-body">
                <div id="modalContent"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    Kapat
                </button>
                <button id="modalSaveBtn" type="button" class="btn btn-primary">
                    Kaydet
                </button>
            </div>
        </div>
    </div>
</div>
@section Scripts{
    <script src="~/assets/customscripts/sharedfuncs.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs/Sortable.min.js"></script>
    <script src="~/assets/js/SlickGrid/dist/browser/slick.core.js"></script>
    <script src="~/assets/js/SlickGrid/dist/browser/slick.interactions.js"></script>
    <script src="~/assets/js/SlickGrid/dist/browser/slick.grid.js"></script>
    <script src="~/assets/js/SlickGrid/dist/browser/slick.formatters.js"></script>
    <script src="~/assets/js/SlickGrid/dist/browser/slick.editors.js"></script>
    <script src="~/assets/js/SlickGrid/dist/browser/plugins/slick.rowselectionmodel.js"></script>
    <script src="~/assets/js/SlickGrid/dist/browser/slick.dataview.js"></script>
    <script src="~/assets/js/SlickGrid/dist/browser/controls/slick.pager.js"></script>
    <script src="~/assets/js/SlickGrid/dist/browser/controls/slick.columnpicker.js"></script>
    @Html.Partial("~/Views/TeknikIslemler/Partials/_FiyatListeMalGrid.cshtml")

    <script>
        var target = "";
        $(document).on("show.bs.modal", "#modal", function (e) {
            var btn = $(e.relatedTarget);
            var container = $("#modalContent");
            var label = $("#modalLabel");

            container.empty();
            label.empty();



            if (btn.data("remote-url")) {
                target = btn.data("btarget");
                switch (target) {
                    default: container.load(btn.data("remote-url")); break;
                }
                label.text(btn.data("label"));
            } else {
                target = e.relatedTarget.target;
            }
        });

        $(document).on("hidden.bs.modal", "#modal", function (e) {
            $("#modalContent").empty();
            $("#modalLabel").empty();

            var malId = document.getElementById("gridMal").getAttribute("data-id");
            switch (target) {
                case "mal": updateMalCell(malId, $("#gridMal").val()); goToNextCol(); break;
            }
        });
        $(document).ready(function () {
            document.getElementById('listeKaydetBut').addEventListener('click', function () {
                postGrid();
            });
        });
    </script>
}